<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="date" content="2021-08-22" />
<link rel="stylesheet" href="https://shijingchang.cn/doc/assets/css/tufte.min.css">
<link href="https://fonts.loli.net/css2?family=Fira+Code&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://shijingchang.cn/doc/assets/css/extra.css">
<link href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.6/katex.min.css" rel="stylesheet">
<script src="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.6/katex.min.js"></script>
<script defer src="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.6/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
</head>

<body>
<div id="header">
<h1 class="title">Vim</h1>
<h3 class="date">2021-08-22</h3>
<div id="TOC">
<ul>
<li><a href="#basics" id="toc-basics"><span
class="toc-section-number">1</span> Basics</a>
<ul>
<li><a href="#edit" id="toc-edit"><span
class="toc-section-number">1.1</span> Edit</a>
<ul>
<li><a href="#join-two-lines" id="toc-join-two-lines"><span
class="toc-section-number">1.1.1</span> Join Two Lines</a></li>
<li><a href="#global-command-g" id="toc-global-command-g"><span
class="toc-section-number">1.1.2</span> Global Command
<code>:g</code></a></li>
</ul></li>
<li><a href="#folding" id="toc-folding"><span
class="toc-section-number">1.2</span> Folding</a>
<ul>
<li><a href="#basic-shortcuts" id="toc-basic-shortcuts"><span
class="toc-section-number">1.2.1</span> Basic shortcuts</a></li>
</ul></li>
</ul></li>
<li><a href="#advanced" id="toc-advanced"><span
class="toc-section-number">2</span> Advanced</a>
<ul>
<li><a href="#edit-1" id="toc-edit-1"><span
class="toc-section-number">2.1</span> Edit</a>
<ul>
<li><a href="#fix-syntax-highlighting"
id="toc-fix-syntax-highlighting"><span
class="toc-section-number">2.1.1</span> Fix syntax highlighting</a></li>
<li><a href="#replace-tab-with-whitespaces"
id="toc-replace-tab-with-whitespaces"><span
class="toc-section-number">2.1.2</span> Replace Tab with
Whitespaces</a></li>
<li><a href="#replace-string-within-a-range-of-lines"
id="toc-replace-string-within-a-range-of-lines"><span
class="toc-section-number">2.1.3</span> Replace string within a range of
lines</a></li>
<li><a href="#replace-string-matching-the-whole-word"
id="toc-replace-string-matching-the-whole-word"><span
class="toc-section-number">2.1.4</span> Replace string matching the
whole word</a></li>
<li><a href="#paste-a-column-of-text-after-a-different-column-of-text"
id="toc-paste-a-column-of-text-after-a-different-column-of-text"><span
class="toc-section-number">2.1.5</span> Paste a column of text after a
different column of text</a></li>
<li><a href="#paste-in-insert-mode" id="toc-paste-in-insert-mode"><span
class="toc-section-number">2.1.6</span> Paste in Insert Mode</a></li>
<li><a href="#record-commands-and-replay"
id="toc-record-commands-and-replay"><span
class="toc-section-number">2.1.7</span> Record commands and
replay</a></li>
<li><a href="#remove-and-all-of-the-escape-sequences"
id="toc-remove-and-all-of-the-escape-sequences"><span
class="toc-section-number">2.1.8</span> Remove <code>^[</code> and all
of the escape sequences</a></li>
<li><a href="#append-the-output-of-an-shell-command"
id="toc-append-the-output-of-an-shell-command"><span
class="toc-section-number">2.1.9</span> Append the Output of an Shell
Command</a></li>
</ul></li>
<li><a href="#configuration" id="toc-configuration"><span
class="toc-section-number">2.2</span> Configuration</a>
<ul>
<li><a href="#slow-when-editing-chinese"
id="toc-slow-when-editing-chinese"><span
class="toc-section-number">2.2.1</span> Slow when editing
Chinese</a></li>
<li><a href="#convert-dos-line-endings-to-linux-line-endings-in-vim"
id="toc-convert-dos-line-endings-to-linux-line-endings-in-vim"><span
class="toc-section-number">2.2.2</span> Convert DOS line endings to
Linux line endings in vim</a></li>
<li><a href="#encoding" id="toc-encoding"><span
class="toc-section-number">2.2.3</span> Encoding</a></li>
<li><a href="#monitor-real-time-changes"
id="toc-monitor-real-time-changes"><span
class="toc-section-number">2.2.4</span> Monitor Real Time
Changes</a></li>
<li><a href="#disable-bell-sound" id="toc-disable-bell-sound"><span
class="toc-section-number">2.2.5</span> Disable bell sound</a></li>
<li><a href="#match-angle-bracket" id="toc-match-angle-bracket"><span
class="toc-section-number">2.2.6</span> Match angle bracket
<code>&lt;&gt;</code></a></li>
</ul></li>
<li><a href="#system-and-application"
id="toc-system-and-application"><span
class="toc-section-number">2.3</span> System and application</a>
<ul>
<li><a href="#find-which-plugin-making-vim-slow"
id="toc-find-which-plugin-making-vim-slow"><span
class="toc-section-number">2.3.1</span> Find which plugin making Vim
slow</a></li>
<li><a
href="#saving-file-under-dropbox-sync-directory-causing-long-waiting-time"
id="toc-saving-file-under-dropbox-sync-directory-causing-long-waiting-time"><span
class="toc-section-number">2.3.2</span> Saving File Under Dropbox Sync
Directory Causing Long Waiting Time</a></li>
<li><a href="#windows-gvim-background-color-not-initialized-since-8.2"
id="toc-windows-gvim-background-color-not-initialized-since-8.2"><span
class="toc-section-number">2.3.3</span> Windows: gvim background color
not initialized since 8.2</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="wrapper">
<h1 data-number="1" id="basics"><span
class="header-section-number">1</span> Basics</h1>
<h2 data-number="1.1" id="edit"><span
class="header-section-number">1.1</span> Edit</h2>
<h3 data-number="1.1.1" id="join-two-lines"><span
class="header-section-number">1.1.1</span> Join Two Lines</h3>
<p>Press the uppercase <code>J</code>.</p>
<h3 data-number="1.1.2" id="global-command-g"><span
class="header-section-number">1.1.2</span> Global Command
<code>:g</code></h3>
<p>Delete all lines matching a pattern.</p>
<pre><code>:g/pattern/d</code></pre>
<p>Delete all lines that do not match a pattern.</p>
<pre><code>:g!/pattern/d
:v/pattern/d</code></pre>
<p>Delete all blank lines (<code>^</code> is start of line;
<code>\s*</code> is zero or more whitespace characters; <code>$</code>
is end of line).</p>
<pre><code>:g/^\s*$/d</code></pre>
<h2 data-number="1.2" id="folding"><span
class="header-section-number">1.2</span> Folding</h2>
<h3 data-number="1.2.1" id="basic-shortcuts"><span
class="header-section-number">1.2.1</span> Basic shortcuts</h3>
<ul>
<li><code>zo</code>: open the fold under the current cursor</li>
<li><code>zO</code>: Open the folds throughout the whole buffer</li>
<li><code>zc</code>: close the fold under the current cursor</li>
<li><code>zC</code>: Close the folds throughout the whole buffer</li>
<li><code>za</code>: toggle the folding under the current cursor</li>
<li><code>zA</code>: Toggle the folding throughout the whole buffer</li>
<li><code>zr</code>: reduce the folding by opening one more level of
folds throughout the whole buffer</li>
<li><code>zR</code>: Reduce the folding by opening all levels of folds
throughout the whole buffer</li>
<li><code>zm</code>: give more folding by closing one more level of
folds throughout the whole buffer</li>
<li><code>zM</code>: Give more folding by closing all levels of folds
throughout the whole buffer</li>
</ul>
<h1 data-number="2" id="advanced"><span
class="header-section-number">2</span> Advanced</h1>
<h2 data-number="2.1" id="edit-1"><span
class="header-section-number">2.1</span> Edit</h2>
<h3 data-number="2.1.1" id="fix-syntax-highlighting"><span
class="header-section-number">2.1.1</span> Fix syntax highlighting</h3>
<p>Sometimes the syntax highlighting is broken. Use
<code>:syntax sync fromstart</code> to fix it.</p>
<h3 data-number="2.1.2" id="replace-tab-with-whitespaces"><span
class="header-section-number">2.1.2</span> Replace Tab with
Whitespaces</h3>
<p>Use <code>:retab</code>.</p>
<h3 data-number="2.1.3"
id="replace-string-within-a-range-of-lines"><span
class="header-section-number">2.1.3</span> Replace string within a range
of lines</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">:376,549s/\\</span><span class="op">&lt;</span>abc\\<span class="op">&gt;</span>/edf/g</span></code></pre></div>
<h3 data-number="2.1.4"
id="replace-string-matching-the-whole-word"><span
class="header-section-number">2.1.4</span> Replace string matching the
whole word</h3>
<p>Normally do as follows,</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">:%s/\\</span><span class="op">&lt;</span>abs\\<span class="op">&gt;</span>/bng/g</span></code></pre></div>
<p>However, typing <code>\\&lt; \\&gt;</code> each time is tedious.
Since my <code>vimrc</code> file highlights the word where the cursor
locates, I can directly run the following command when the cursor is at
<code>abs</code>.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">:%s//bng/g</span></span></code></pre></div>
<h3 data-number="2.1.5"
id="paste-a-column-of-text-after-a-different-column-of-text"><span
class="header-section-number">2.1.5</span> Paste a column of text after
a different column of text</h3>
<p>For example, I have</p>
<pre><code>abc
def
ghi</code></pre>
<p>and</p>
<pre><code>123
456
789</code></pre>
<p>and I want</p>
<pre><code>123 abc
456 def
789 ghi</code></pre>
<p>The solution is: Use visual block (ctrl-v) to cut the letter column.
Then move to the first line of the number column. Move to the end and
make one space. Then paste the letter column.</p>
<h3 data-number="2.1.6" id="paste-in-insert-mode"><span
class="header-section-number">2.1.6</span> Paste in Insert Mode</h3>
<p><code>CTRL-R {register}</code> pastes things in the insert mode. For
example, <code>CTRL-R *</code> will insert in the contents of the
clipboard and <code>CTRL-R "</code> (the unnamed register) inserts the
the last delete or yank.</p>
<h3 data-number="2.1.7" id="record-commands-and-replay"><span
class="header-section-number">2.1.7</span> Record commands and
replay</h3>
<ol type="1">
<li>Enter the recording mode: press <code>q</code> in the normal mode
<ul>
<li>Store the commands in the named register <code>a</code>: press
<code>qa</code>.</li>
</ul></li>
<li>Do something</li>
<li>Stop the recording: press <code>q</code>.</li>
<li>Replay: <code>9@a</code></li>
</ol>
<h3 data-number="2.1.8"
id="remove-and-all-of-the-escape-sequences"><span
class="header-section-number">2.1.8</span> Remove <code>^[</code> and
all of the escape sequences</h3>
<p>The escape sequences are ASCII escape sequences which could be used
to render colored text in the terminal.</p>
<p>Using keyboard entry:</p>
<pre><code>sed &#39;s/[Ctrl-v][Esc]//g&#39;</code></pre>
<p>alternatively</p>
<pre><code>sed &#39;s/[Ctrl-v][Ctrl-[]//g&#39;</code></pre>
<p>where <code>[Ctrl-v]</code> is the key <code>Ctrl</code> + key
<code>v</code>.</p>
<h3 data-number="2.1.9" id="append-the-output-of-an-shell-command"><span
class="header-section-number">2.1.9</span> Append the Output of an Shell
Command</h3>
<p>Use <code>:read</code>. For example, <code>:read !pwd</code>.</p>
<h2 data-number="2.2" id="configuration"><span
class="header-section-number">2.2</span> Configuration</h2>
<h3 data-number="2.2.1" id="slow-when-editing-chinese"><span
class="header-section-number">2.2.1</span> Slow when editing
Chinese</h3>
<p>Enable spellcheck for Chinese</p>
<pre><code>set spell spelllang=en_us,cjk</code></pre>
<h3 data-number="2.2.2"
id="convert-dos-line-endings-to-linux-line-endings-in-vim"><span
class="header-section-number">2.2.2</span> Convert DOS line endings to
Linux line endings in vim</h3>
<pre><code>set ff=unix</code></pre>
<h3 data-number="2.2.3" id="encoding"><span
class="header-section-number">2.2.3</span> Encoding</h3>
<pre><code>set encoding=utf-8  &quot; The encoding displayed.
set fileencoding=utf-8  &quot; The encoding written to file.</code></pre>
<h3 data-number="2.2.4" id="monitor-real-time-changes"><span
class="header-section-number">2.2.4</span> Monitor Real Time
Changes</h3>
<pre><code>set autoread</code></pre>
<h3 data-number="2.2.5" id="disable-bell-sound"><span
class="header-section-number">2.2.5</span> Disable bell sound</h3>
<pre><code>set belloff=all</code></pre>
<h3 data-number="2.2.6" id="match-angle-bracket"><span
class="header-section-number">2.2.6</span> Match angle bracket
<code>&lt;&gt;</code></h3>
<pre><code>:set matchpairs+=&lt;:&gt;</code></pre>
<p><a
href="https://vi.stackexchange.com/questions/9729/percent-key-matching-behavior-for-angle-brackets">Reference</a></p>
<h2 data-number="2.3" id="system-and-application"><span
class="header-section-number">2.3</span> System and application</h2>
<h3 data-number="2.3.1" id="find-which-plugin-making-vim-slow"><span
class="header-section-number">2.3.1</span> Find which plugin making Vim
slow</h3>
<pre><code>vim --startuptime timeCost.txt timeCost.txt</code></pre>
<h3 data-number="2.3.2"
id="saving-file-under-dropbox-sync-directory-causing-long-waiting-time"><span
class="header-section-number">2.3.2</span> Saving File Under Dropbox
Sync Directory Causing Long Waiting Time</h3>
<p>This behavior occurs on my work machine, an old version of debian. I
cannot upgrade the system. Therefore I googled and found the
solution.</p>
<p>It is caused by the backupcopy feature of Vim. The simple solution
is</p>
<pre><code>set backupcopy=yes</code></pre>
<p>Reference: <a
href="https://vi.stackexchange.com/questions/4038/why-does-set-nocompatible-result-in-vim-saving-extra-all-numeric-temporary-fi">link</a>.</p>
<h3 data-number="2.3.3"
id="windows-gvim-background-color-not-initialized-since-8.2"><span
class="header-section-number">2.3.3</span> Windows: gvim background
color not initialized since 8.2</h3>
<p>vim 8.2 includes a default <code>_gvimrc</code> that has a “set nice
colors” (hah) block of highlight commands in it. Create a blank
<code>.gvimrc</code> in the home directory, and that fixes the problem.
I’m installing vim with scoop in case that matters.</p>
</div>
<div class="customHr">.</div>
<footer>
  Created on 2021-08-22 with pandoc
</footer>
</body>
</html>
